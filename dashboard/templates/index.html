<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>API Spec Generator Dashboard</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
  <div class="container">
    <h1>ğŸ“˜ API Spec Generator</h1>
    <div class="steps">
      <button onclick="runStep('static')">ğŸ” Run Static Extractor</button>
      <button onclick="runStep('merge_openapi')">ğŸ”„ Merge with OpenAPI</button>
      <button onclick="runStep('record_har')">ğŸ¥ Record HAR</button>
      <button onclick="runStep('extract_har')">ğŸ“Š Extract from HAR</button>
      <button onclick="runStep('super_merge')">ğŸ§  Smart Merge</button>
    </div>
    <pre id="output">Click a button to start...</pre>
    <h3>ğŸ“¥ Download</h3>
    <ul>
      <li><a href="/download/static_routes_full.json" target="_blank">static_routes_full.json</a></li>
      <li><a href="/download/merged_openapi.yaml" target="_blank">merged_openapi.yaml</a></li>
      <li><a href="/download/full_har_openapi.yaml" target="_blank">full_har_openapi.yaml</a></li>
      <li><a href="/download/full_har_endpoints.json" target="_blank">full_har_endpoints.json</a></li>
      <li><a href="/download/merged_spec_smart.yaml" target="_blank">merged_spec_smart.yaml</a></li>
    </ul>
  </div>

  <script>
    async function runStep(step) {
      document.getElementById('output').textContent = 'â³ Running ' + step + '...';
      const response = await fetch('/run', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ step })
      });
      const data = await response.json();
      if (data.success) {
        document.getElementById('output').textContent = 'âœ… Success:\n' + data.output;
      } else {
        document.getElementById('output').textContent = 'âŒ Error:\n' + (data.output || data.error);
      }
    }
  </script>
</body>
</html>